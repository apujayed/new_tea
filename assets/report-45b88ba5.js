import{O as S,s as b,r as s,d as g,a as j,j as e,B as E,n as F}from"./index-9bd05b6a.js";import{M as L,c as $}from"./index.esm-23b2bf72.js";import{I as k}from"./input-ff7d458e.js";import{B as I}from"./combobox-7458bbdd.js";const v=new S(b);function G({data:t}){const[x,l]=s.useState(""),[d,m]=s.useState(""),[h,i]=s.useState(""),[u,r]=s.useState(!1),[n,w]=s.useState("");return s.useEffect(()=>{g(`${j}`,"factories").map(a=>{a.id===t.Factory&&l(a.Company_name)});const o=g(`${j}`,"warehouses");o&&o.map(a=>{a.id===t.Warehose&&m(a.Company_name)}),(async()=>{const a=await v.collection("auction_info").getFirstListItem(`catalog="${t.id}"`,{expand:"relField1,relField2.subRelField"});if(a){r(a.Status),i(a.price_max);const y=await v.collection("users").getFirstListItem(`id="${a.bidder_current}"`);y&&w(y.username)}})()},[]),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Lot_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Invoice}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:x}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Grade}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Net_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Package}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Total_kg}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Grand_total}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Offer_price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Collection}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Gross_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Season}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:d}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:h}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:status?e.jsx("div",{className:"text-green-500 text-xl",children:e.jsx(E,{})}):e.jsx("div",{className:"text-red-500 text-xl",children:e.jsx(L,{})})})]})}function T({catalog:t,set_all_lot:x}){return e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:"shadow-md w-[80vw] mx-auto bg-white rounded-lg h-fit",children:[e.jsx("div",{className:"py-3 px-6 border-b border-dashed",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-lg font-semibold tracking-tight text-slate-900",children:"Report"})})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full inline-block align-middle",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lot "}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factory"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Pkg"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Grand Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Offer price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Collection"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Gross weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Season"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Warehouse"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Price max"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(l=>e.jsx(G,{data:l}))})]})})})})})]})})}const _=new S(b);_.autoCancellation(!1);function A(){const[t,x]=s.useState([]),[l,d]=s.useState(!1);return s.useEffect(()=>{(async()=>{const m=[];(await _.collection("auction_info").getFullList({sort:"-created"})).map(r=>{r.bidders.map(n=>{n===_.authStore.model.id&&m.push(r.catalog)})});const i=await _.collection("catalog").getFullList({sort:"-created"});let u=[];i.map(r=>{m.map(n=>{r.id===n&&u.push(r)})}),x(u)})()},[]),e.jsx(T,{set_all_lot:d,catalog:t})}const C=new S(b);function B({data:t}){const[x,l]=s.useState(""),[d,m]=s.useState(""),[h,i]=s.useState(""),[u,r]=s.useState(),[n,w]=s.useState(!1),[p,o]=s.useState("");return s.useEffect(()=>{g(`${j}`,"factories").map(c=>{c.id===t.Factory&&l(c.Company_name)});const y=g(`${j}`,"warehouses");y&&y.map(c=>{c.id===t.Warehose&&m(c.Company_name)}),(async()=>{const c=await C.collection("auction_info").getFirstListItem(`catalog="${t.id}"`,{expand:"relField1,relField2.subRelField"});if(c){r(c.id),w(c.Status),i(c.price_max);const f=await C.collection("users").getFirstListItem(`id="${c.bidder_current}"`);f&&o(f.username)}})()},[]),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Lot_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Invoice}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:x}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Grade}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Net_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Package}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Total_kg}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Grand_total}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Offer_price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Collection}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Gross_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Season}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:d}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:p}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:h}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:n?e.jsx("div",{className:"text-green-500 text-xl",children:e.jsx(E,{})}):e.jsx("div",{className:"text-red-500 text-xl",children:e.jsx(L,{})})})]})}function O({catalog:t,set_all_lot:x}){return e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:"shadow-md w-[80vw] mx-auto bg-white rounded-lg h-fit",children:[e.jsx("div",{className:"py-3 px-6 border-b border-dashed",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-lg font-semibold tracking-tight text-slate-900",children:"Report"})})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full inline-block align-middle",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lot "}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factory"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Pkg"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Grand Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Offer price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Collection"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Gross weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Season"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Warehouse"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Current bidder"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Price max"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(l=>e.jsx(B,{data:l}))})]})})})})})]})})}const N=new S(b);N.autoCancellation(!1);function R(){s.useState(),s.useState([]);const[t,x]=s.useState([]);s.useState(""),s.useState(!1);const[l,d]=s.useState([]);s.useState([]);const[m,h]=s.useState(!1);s.useState(0),s.useState(),s.useState(),s.useState(!1),s.useState(!1);const[i,u]=s.useState(),[r,n]=s.useState();s.useEffect(()=>{(async()=>{try{const p=await N.collection("profiles").getFullList({sort:"-created",filter:'Account_type="Broker"'}),o=g(`${j}`,"catalogs"),a=[...new Set(o.map(f=>f.Season))],y=[...new Set(o.map(f=>f.Sale_number))];x(a);const c=await N.collection("Eligibility").getFullList();u(c[0].Season),n(c[0].Sale_Number)}catch(p){F.error(p.message)}})()},[]),s.useEffect(()=>{(async()=>{const p=await N.collection("catalog").getFullList({sort:"-created",filter:`brokersID="${N.authStore.model.id}"`});let o=[];p.map(a=>{a.Season===i&&a.Sale_number===parseInt(r)&&o.push(a)}),d(o)})()},[i,r]);const w=p=>{n(p.target.value)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex mt-6 justify-between items-center p-4 sm:w-[600px] mx-auto",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"mb-2",children:"Select season"}),e.jsx(I,{selected:i,data:t,change:u})]}),e.jsx("div",{className:"w-2"}),e.jsx("div",{className:"w-1/2",children:e.jsx(k,{title:"Sale Number",type:"number",defaultValue:r,placeholder:"Sale number here...",handle_input_change:w,icon:$})})]}),e.jsx(O,{set_all_lot:h,catalog:l}),e.jsx("br",{})]})}function M(){const[t,x]=s.useState("");return s.useEffect(()=>{const l=g(`${j}`,"profile");x(l[0].Account_type)},[]),e.jsxs(e.Fragment,{children:[t==="Bidder"?e.jsx(A,{}):null,t==="Broker"?e.jsx(R,{}):null]})}export{M as default};
